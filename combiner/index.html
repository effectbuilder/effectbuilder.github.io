<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>SRGB Effect Combiner</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="i18n.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <div id="sidebar">
        <div id="sidebar-scroll-area">
            <div class="app-header">
                <img src="../logo.png" alt="Logo" class="me-2" style="height: 2em;">
                <div style="flex-grow:1;">
                    <h2 data-i18n="title">SRGB Effect Combiner</h2>
                </div>

                <select id="lang-selector" onchange="changeLanguage(this.value)" style="width:auto; margin-bottom:0;">
                    <option value="en">ğŸ‡ºğŸ‡¸ EN</option>
                    <option value="es">ğŸ‡ªğŸ‡¸ ES</option>
                    <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                    <option value="hi">ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
                    <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                </select>
            </div>

            <h3 data-i18n="meta_header">1. Metadata</h3>
            <input type="text" id="meta-title" data-i18n-ph="meta_title_p" value="My Custom Mix" oninput="Persistence.save()">
            <input type="text" id="meta-publisher" data-i18n-ph="meta_pub_p" value="User" oninput="Persistence.save()">
            <textarea id="meta-desc" rows="2" data-i18n-ph="meta_desc_p" oninput="Persistence.save()">A custom composite effect.</textarea>

            <h3 data-i18n="source_header">2. Source Files</h3>
<label class="file-upload" id="btn-upload-label">
    <span data-i18n="btn_add_files">+ Add HTML Effects</span>
    <input type="file" multiple accept=".html" onchange="compositor.handleUpload(this.files)">
</label>
<button class="btn-lib" data-i18n="btn_open_lib" onclick="Library.open()">Open Effect Library</button>

            <h3 data-i18n="layout_header">3. Preview Layout</h3>
            <div class="control-group">
                <div class="layout-grid">
                    <button id="btn-layered" data-i18n="layout_layered" onclick="compositor.setLayout('LAYERED')" class="mode-btn active">Layered</button>
                    <button id="btn-side" data-i18n="layout_side" onclick="compositor.setLayout('SIDE_BY_SIDE')" class="mode-btn">Side/Side</button>
                    <button id="btn-vert" data-i18n="layout_vert" onclick="compositor.setLayout('VERTICAL')" class="mode-btn">Vertical</button>
                    <button id="btn-grid" data-i18n="layout_grid" onclick="compositor.setLayout('GRID')" class="mode-btn">Grid</button>
                    <button id="btn-pip" data-i18n="layout_pip" onclick="compositor.setLayout('PIP')" class="mode-btn">Picture in Picture</button>
                </div>

            </div>

            <h3 data-i18n="layers_header">4. Layers</h3>
            <div id="layer-list"></div>
        </div>

        <div id="sidebar-footer">
            <button id="btn-clear" data-i18n="btn_reset" onclick="Persistence.clear()">Reset</button>
            <button id="btn-export" data-i18n="btn_export" onclick="exporter.download()">Export .ZIP</button>
        </div>
    </div>

    <div id="viewport">
        <canvas id="master-canvas" width="640" height="360"></canvas>
    </div>

    <div id="hidden-sandbox"></div>

    <div id="lib-modal" class="modal-overlay" onclick="if(event.target === this) Library.close()">
        <div class="modal-content" id="modal-content">
            <div class="drop-overlay"></div>
            <div class="modal-header">
                <div style="display:flex; align-items:center;">
                    <h2 id="lib-count-header" data-i18n="lib_header">Library </h2>
                    <span id="lib-count" class="count-badge">(0)</span>
                    <select id="lib-sort" class="sort-select" onchange="Library.setSort(this.value)">
                        <option value="date-desc">Newest First</option>
                        <option value="date-asc">Oldest First</option>
                        <option value="alpha-asc">Name (A-Z)</option>
                        <option value="alpha-desc">Name (Z-A)</option>
                    </select>
                </div>
                <div style="display:flex; align-items:center;">
                    <span id="loading-indicator">Processing...</span>
                    <button id="btn-add-sel" class="btn-modal-action btn-add-sel" onclick="Library.addSelectedToWorkspace()">Add Selected (0)</button>
                    <button class="btn-clear-lib" data-i18n="btn_clear_lib" onclick="Library.clearAll()">ğŸ—‘ Clear</button>
                    <button class="icon-btn btn-close" onclick="Library.close()" style="width:30px; height:30px; font-size:1.2rem; margin-left:10px;">âœ–</button>
                </div>
            </div>
            <div id="lib-grid" class="lib-grid">
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>

</html>