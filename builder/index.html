<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SRGB Component Builder</title>
    <meta property="og:title" content="SRGB Component Builder">
    <meta property="og:description" content="A tool for creating custom LED component layouts for SignalRGB.">
    <meta property="og:type" content="website">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <script type="module" src="firebase.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body class="d-flex flex-column vh-100">
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="./">
                <img src="../logo.png" alt="Effect Builder Logo" class="me-2" style="height: 1.5em;"> SRGB Component Builder
            </a>

            <div class="ms-auto d-flex align-items-center">

                <div class="btn-group me-3" role="group" aria-label="Project management actions">
                    <button class="btn btn-primary" id="new-component-btn" data-bs-toggle="tooltip" title="New Component"><i class="bi bi-file-earmark-plus me-1"></i> New</button>
                    <button class="btn btn-primary" id="save-component-btn" data-bs-toggle="tooltip" title="Save current component to the cloud" disabled><i class="bi bi-cloud-arrow-up me-1"></i> Save</button>
                    <button class="btn btn-secondary" id="share-component-btn" data-bs-toggle="tooltip" title="Get a shareable link to this component" disabled><i class="bi bi-share me-1"></i> Share</button>
                    <button class="btn btn-secondary" id="import-json-btn" data-bs-toggle="tooltip" title="Import Component from JSON file"> <i class="bi bi-upload me-1"></i> Import JSON</button>
                    <button class="btn btn-secondary" id="export-component-btn" data-bs-toggle="modal" data-bs-target="#export-component-modal" title="Download Component JSON file"> <i class="bi bi-download me-1"></i> Export JSON</button>
                </div>

                <div class="btn-group me-3" role="group" aria-label="Community">
                    <a href="gallery.html" class="btn btn-primary" id="browse-gallery-btn" title="Browse the Community Component Gallery">
                        <i class="bi bi-view-list me-1"></i> Community Gallery
                    </a>
                </div>

                <div class="btn-group me-3" role="group" aria-label="Editor">
                    <a href="../" class="btn btn-dark" title="Effect Builder"><i class="bi bi-view-list me-1"></i> Effect Builder</a>
                </div>

                <div class="btn-group me-3" role="group" aria-label="Help and settings">
                    <button class="btn btn-secondary" id="help-btn" data-bs-toggle="modal" data-bs-target="#help-modal" title="Help"><i class="bi bi-question-circle"></i></button>
                    <button class="btn btn-secondary" id="about-btn" data-bs-toggle="modal" data-bs-target="#about-modal" title="About"><i class="bi bi-info-circle"></i></button>
                    <a class="btn btn-secondary" id="contact-btn" href="https://github.com/effectbuilder/effectbuilder.github.io/issues/new/choose" target="_blank" rel="noopener" title="Report Bug / Request Feature on GitHub">
                        <i class="bi bi-github"></i>
                    </a>
                    <button class="btn btn-secondary" type="button" id="theme-switcher-btn" title="Change Theme">
                        <i class="bi" id="theme-icon"></i>
                    </button>
                </div>

                <div id="auth-notification-block" class="d-flex align-items-center">
                    <button class="btn btn-success" id="login-btn"><i class="bi bi-google me-2"></i>Sign In</button>
                    <div class="btn-group d-none" id="user-session-group" role="group" aria-label="User actions">
                        
                        <div class="btn-group" role="group">
                            <button class="btn btn-info dropdown-toggle position-relative" type="button" id="notification-dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" disabled>
                                <i class="bi bi-bell"></i>
                                <span id="notification-badge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger d-none">
                                    0
                                    <span class="visually-hidden">new notifications</span>
                                </span>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end dropdown-menu-dark p-2" aria-labelledby="notification-dropdown-toggle" style="min-width: 300px;">
                                <li class="dropdown-header d-flex justify-content-between align-items-center">
                                    <strong>Notifications</strong>
                                    <div> <button class="btn btn-sm btn-link text-info p-0 me-2" id="mark-all-read-btn" style="display: none;">Mark All Read</button>
                                        <button class="btn btn-sm btn-link text-danger p-0" id="delete-all-read-btn" style="display: none;" title="Delete all read notifications">
                                            Clear Read
                                        </button>
                                    </div>
                                </li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <div id="notification-list-container" style="max-height: 400px; overflow-y: auto;">
                                    <li class="dropdown-item disabled text-center text-body-secondary small p-3">
                                        <i class="bi bi-person-fill me-1"></i> Sign in to view notifications.
                                    </li>
                                </div>
                            </ul>
                        </div>
                        <span class="btn btn-secondary d-flex align-items-center disabled" style="pointer-events: none;">
                            <img id="user-photo" class="rounded-circle me-2" style="width: 24px; height: 24px;" alt="User profile photo">
                            <span id="user-display"></span>
                        </span>
                        <button class="btn btn-danger" id="logout-btn" title="Sign Out"><i class="bi bi-box-arrow-right"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-fluid flex-grow-1 overflow-hidden p-0">
        <div class="h-100" id="main-split">

            <div id="left-panel" class="h-100 border-end bg-body-tertiary">
                <div class="d-flex flex-column p-3">
                    <div id="component-properties" class="mb-3">
                        <h4 class="text-body-emphasis">Component Properties</h4>
                        <div class="row mb-2">
                            <div class="col">
                                <label for="component-name" class="form-label form-label-sm">Product Name</label>
                                <input type="text" id="component-name" class="form-control form-control-sm" placeholder="e.g., My Custom Fan">
                            </div>
                        </div>
                        <div class="row mb-2">
                            <div class="col">
                                <label for="component-display-name" class="form-label form-label-sm">Display Name</label>
                                <input type="text" id="component-display-name" class="form-control form-control-sm" placeholder="e.g., My Custom Fan">
                            </div>
                        </div>
                        <div class="row mb-2">
                            <div class="col">
                                <label for="component-brand" class="form-label form-label-sm">Brand</label>
                                <input type="text" id="component-brand" class="form-control form-control-sm" placeholder="e.g., Custom">
                            </div>
                            <div class="col">
                                <label for="component-type" class="form-label form-label-sm">Component Type</label>
                                <select id="component-type" class="form-select form-select-sm">
                                    <option>AIO Liquid Cooler</option>
                                    <option>Air Cooler</option>
                                    <option>Case</option>
                                    <option>Desk</option>
                                    <option>Fan</option>
                                    <option>GPU</option>
                                    <option>Headset</option>
                                    <option>Headset Stand</option>
                                    <option>Keyboard</option>
                                    <option>Matrix</option>
                                    <option>Motherboard</option>
                                    <option>Monitor</option>
                                    <option>Mouse</option>
                                    <option>Mousepad</option>
                                    <option>PSU</option>
                                    <option>RAM</option>
                                    <option>Speaker</option>
                                    <option>Storage</option>
                                    <option>Strimer</option>
                                    <option>Strip</option>
                                    <option>Other</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-2">
                            <label for="component-image" class="form-label form-label-sm">Device Image (Optional)</label>
                            <input type="file" id="component-image" class="form-control form-control-sm" accept="image/png, image/webp">
                            <div class="form-text mb-1">Max 400x400 pixels.</div>

                            <div id="image-paste-zone" class="p-3 text-center text-muted border border-dashed rounded-3" style="cursor: copy; min-height: 100px; display: flex; align-items: center; justify-content: center; background-color: var(--bs-body-bg);" contenteditable="true" title="Click here and press Ctrl+V to paste an image">

                                <img id="image-preview" src="#" alt="Image Preview" class="img-fluid rounded" style="max-width: 100%; display: none;">

                                <span id="image-paste-placeholder" style="pointer-events: none;">
                                    <i class="bi bi-clipboard-plus fs-3"></i>
                                    <br>
                                    Click to paste image
                                </span>
                            </div>
                            <div class="form-text mb-1">
                                Click the above box and use <span class="badge bg-secondary">Ctrl</span> + <span class="badge bg-secondary">V</span> to paste, or press <span class="badge bg-secondary">Delete</span> to remove. You can also use drag-and-drop.
                            </div>
                        </div>
                        <hr>
                    </div>

                    <div id="elements-and-wiring" class="pe-2">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h4 class="text-body-emphasis mb-0">Shapes</h4>
                            <span id="led-count-display" class="badge bg-secondary rounded-pill fs-6">0 LEDs</span>
                        </div>
                        <div id="led-warning-display" class="form-text text-warning d-none" style="margin-top: -0.5rem; margin-bottom: 0.5rem;">
                            <i class="bi bi-exclamation-triangle-fill me-1"></i>
                            Most motherboard ARGB headers support ~120 LEDs. You are adding more at your own risk!
                        </div>
                        <div class="mb-3">
                            <div class="shape-gallery">

                                <button class="btn btn-outline-secondary shape-gallery-item" id="add-matrix-btn" data-bs-toggle="tooltip" title="Add Matrix Shape">
                                    <svg viewBox="0 0 32 32" fill="currentColor" width="32" height="32" class="d-block mb-1">
                                        <circle cx="8" cy="8" r="3" />
                                        <circle cx="16" cy="8" r="3" />
                                        <circle cx="24" cy="8" r="3" />
                                        <circle cx="8" cy="16" r="3" />
                                        <circle cx="16" cy="16" r="3" />
                                        <circle cx="24" cy="16" r="3" />
                                        <circle cx="8" cy="24" r="3" />
                                        <circle cx="16" cy="24" r="3" />
                                        <circle cx="24" cy="24" r="3" />
                                    </svg>
                                    <small>Matrix</small>
                                </button>

                                <button class="btn btn-outline-secondary shape-gallery-item" id="add-strip-btn" data-bs-toggle="tooltip" title="Add Strip Shape">
                                    <svg viewBox="0 0 32 32" fill="currentColor" width="32" height="32" class="d-block mb-1">
                                        <circle cx="8" cy="16" r="3" />
                                        <circle cx="16" cy="16" r="3" />
                                        <circle cx="24" cy="16" r="3" />
                                    </svg>
                                    <small>Strip</small>
                                </button>

                                <button class="btn btn-outline-secondary shape-gallery-item" id="add-circle-btn" data-bs-toggle="tooltip" title="Add Circle Shape">
                                    <svg viewBox="0 0 32 32" fill="currentColor" width="32" height="32" class="d-block mb-1">
                                        <circle cx="26" cy="16" r="3" />
                                        <circle cx="23" cy="23" r="3" />
                                        <circle cx="16" cy="26" r="3" />
                                        <circle cx="9" cy="23" r="3" />
                                        <circle cx="6" cy="16" r="3" />
                                        <circle cx="9" cy="9" r="3" />
                                        <circle cx="16" cy="6" r="3" />
                                        <circle cx="23" cy="9" r="3" />
                                    </svg>
                                    <small>Circle</small>
                                </button>

                                <button class="btn btn-outline-secondary shape-gallery-item" id="add-l-shape-btn" data-bs-toggle="tooltip" title="L Shape">
                                    <svg viewBox="0 0 32 32" fill="currentColor" width="32" height="32" class="d-block mb-1">
                                        <circle cx="8" cy="8" r="3" />
                                        <circle cx="8" cy="16" r="3" />
                                        <circle cx="8" cy="24" r="3" />
                                        <circle cx="16" cy="24" r="3" />
                                    </svg>
                                    <small>L Shape</small>
                                </button>

                                <button class="btn btn-outline-secondary shape-gallery-item" id="add-u-shape-btn" data-bs-toggle="tooltip" title="U Shape">
                                    <svg viewBox="0 0 32 32" fill="currentColor" width="32" height="32" class="d-block mb-1">
                                        <circle cx="8" cy="8" r="3" />
                                        <circle cx="24" cy="8" r="3" />
                                        <circle cx="8" cy="16" r="3" />
                                        <circle cx="24" cy="16" r="3" />
                                        <circle cx="8" cy="24" r="3" />
                                        <circle cx="16" cy="24" r="3" />
                                        <circle cx="24" cy="24" r="3" />
                                    </svg>
                                    <small>U Shape</small>
                                </button>

                                <button class="btn btn-outline-secondary shape-gallery-item" id="add-triangle-btn" data-bs-toggle="tooltip" title="Triangle Shape">
                                    <svg viewBox="0 0 32 32" fill="currentColor" width="32" height="32" class="d-block mb-1">
                                        <circle cx="16" cy="8" r="3" />
                                        <circle cx="8" cy="24" r="3" />
                                        <circle cx="24" cy="24" r="3" />
                                        <circle cx="20" cy="16" r="3" />
                                        <circle cx="12" cy="16" r="3" />
                                        <circle cx="16" cy="24" r="3" />
                                    </svg>
                                    <small>Triangle</small>
                                </button>

                                <button class="btn btn-outline-secondary shape-gallery-item" id="add-hexagon-btn" data-bs-toggle="tooltip" title="Hexagon Shape">
                                    <svg viewBox="0 0 32 32" fill="currentColor" width="32" height="32" class="d-block mb-1">
                                        <circle cx="16" cy="6" r="3" />
                                        <circle cx="25" cy="11" r="3" />
                                        <circle cx="25" cy="21" r="3" />
                                        <circle cx="16" cy="26" r="3" />
                                        <circle cx="7" cy="21" r="3" />
                                        <circle cx="7" cy="11" r="3" />
                                    </svg>
                                    <small>Hexagon</small>
                                </button>

                            </div>
                        </div>

                        <svg class="d-none" id="svg-placeholder-shape">
                            <symbol viewBox="0 0 32 32" id="shape-placeholder">
                                <path fill="none" stroke="currentColor" stroke-width="2" stroke-dasharray="4 2" d="M6 6h20v20H6z" />
                            </symbol>
                        </svg>
                    </div>
                    <hr>
                    <div id="component-comments-section" class="mt-2">
                        <h4 class="text-body-emphasis mb-3">Comments</h4>

                        <div class="alert alert-info small p-2" role="alert">
                            <i class="bi bi-info-circle me-1"></i> Comments are public. Please be respectful and courteous.
                        </div>
                        <div id="comment-list" class="pe-2 mb-3" style="max-height: 400px; overflow-y: auto;">
                            <p id="comments-loading-placeholder" class="text-muted" style="display: none;">
                                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                Loading comments...
                            </p>
                            <p id="comments-save-prompt" class="text-muted" style="display: none;">
                                Save this component to the cloud to enable comments.
                            </p>
                        </div>

                        <form id="comment-form" class="pe-2" style="display: none;">
                            <div class="mb-2">
                                <label for="comment-textarea" class="form-label form-label-sm">Add a comment</label>
                                <textarea id="comment-textarea" class="form-control form-control-sm" rows="3" placeholder="Write your comment..." required></textarea>
                            </div>
                            <button id="comment-submit-btn" type="submit" class="btn btn-primary btn-sm">
                                <i class="bi bi-send me-1"></i> Post Comment
                            </button>
                        </form>

                        <div id="comment-login-prompt" class="alert alert-info" style="display: none;">
                            Please <a href="#" id="comment-login-link">sign in</a> to post a comment.
                        </div>
                    </div>
                </div>
            </div>

            <div id="right-panel" class="d-flex flex-column h-100">
                <div id="toolbar" class="bg-body-tertiary p-2 rounded d-flex flex-wrap">

                    <div class="btn-group me-2 mb-1" role="group">
                        <button class="btn btn-secondary" id="tool-select-btn" data-bs-toggle="tooltip" title="Select Tool (V)"><i class="bi bi-cursor-fill"></i></button>
                        <button class="btn btn-secondary" id="tool-place-led-btn" data-bs-toggle="tooltip" title="Place LED Tool (P)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M 8 12 L 8 7 A 4 4 0 0 1 16 7 L 16 12" />
                                <line x1="5" y1="12" x2="19" y2="12" />
                                <line x1="10" y1="12" x2="10" y2="21" />
                                <line x1="14" y1="12" x2="14" y2="18" />
                            </svg></button>
                        <button class="btn btn-secondary" data-bs-toggle="tooltip" id="tool-wiring-btn" title="Wiring Tool (W)"><svg fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="100" stroke-width="0.4" version="1.1" viewBox="0 0 6.3499999 6.3499999" width="24" xmlns="http://www.w3.org/2000/svg">
                                <g transform="translate(-46.037502,-98.02813)">
                                    <g transform="translate(0.02893145,-0.22444121)">
                                        <path d="m 50.761393,100.55879 -1.608372,-1.630871 c 0,0 -0.569756,-0.561802 -1.147231,0.01125 -0.577475,0.573052 -0.101226,1.158471 -0.101226,1.158471 l 2.418182,2.48567 c 0,0 0.621202,0.6338 0.06282,1.29152 -0.558378,0.65772 -1.198809,0.0244 -1.198809,0.0244 l -1.552136,-1.58588" />
                                        <g>
                                            <path d="m 50.907609,101.42483 -0.393658,-0.39365 c 0,0 -0.109013,-0.11396 0.02249,-0.24745 0.131503,-0.13349 0.447323,-0.45396 0.494884,-0.49488 0.04756,-0.0409 0.163606,-0.0475 0.236195,0.0225 0.07259,0.07 0.371162,0.37117 0.371162,0.37117 z" />
                                            <path d="m 51.496063,100.82733 0.271904,0.24306 -0.452161,0.45944 -0.265579,-0.24981 z" />
                                        </g>
                                        <g transform="rotate(180,49.264943,101.27615)">
                                            <path d="m 51.070354,101.14683 -0.393658,-0.39365 c 0,0 -0.109013,-0.11396 0.02249,-0.24745 0.131503,-0.13349 0.447323,-0.45396 0.494884,-0.49488 0.04756,-0.0409 0.163606,-0.0475 0.236195,0.0225 0.07259,0.07 0.371162,0.37117 0.371162,0.37117 z" />
                                            <path d="m 51.658808,100.54933 0.271904,0.24306 -0.452161,0.45944 -0.265579,-0.24981 z" />
                                        </g>
                                    </g>
                                </g>
                            </svg></button>
                    </div>

                    <div class="btn-group me-2 mb-1" role="group">
                        <button class="btn btn-secondary" id="image-upload-trigger-btn" data-bs-toggle="tooltip" title="Upload or Replace Image"><i class="bi bi-upload"></i></button>
                        <button class="btn btn-secondary" id="tool-image-btn" data-bs-toggle="tooltip" title="Image Guide Tool (I)"><i class="bi bi-image"></i></button>
                        <button class="btn btn-secondary" id="toggle-image-lock-btn" data-bs-toggle="tooltip" title="Unlock Image (L)" disabled><i class="bi bi-unlock-fill"></i></button>
                        <button class="btn btn-secondary" id="toggle-image-visible-btn" data-bs-toggle="tooltip" title="Hide Image (H)" disabled><i class="bi bi-eye-slash-fill"></i></button>
                        <button class="btn btn-danger" id="clear-image-guide-btn" data-bs-toggle="tooltip" title="Remove Image Guide"><i class="bi bi-trash"></i></button>
                    </div>
                    <div class="btn-group me-2 mb-1" role="group">
                        <button class="btn btn-secondary" id="zoom-in-btn" data-bs-toggle="tooltip" title="Zoom In (+)"><i class="bi bi-zoom-in"></i></button>
                        <button class="btn btn-secondary" id="zoom-out-btn" data-bs-toggle="tooltip" title="Zoom Out (-)"><i class="bi bi-zoom-out"></i></button>
                        <button class="btn btn-secondary" id="zoom-reset-btn" data-bs-toggle="tooltip" title="Reset Zoom (0)"><i class="bi bi-aspect-ratio"></i></button>
                    </div>
                    <div class="btn-group me-2 mb-1" role="group">
                        <button class="btn btn-secondary" id="rotate-selected-btn" title="Rotate Selected LEDs (+90° Counter-Clockwise)"><i class="bi bi-arrow-counterclockwise"></i></button>
                        <button class="btn btn-secondary" id="reverse-selected-btn" data-bs-toggle="tooltip" title="Reverse Wiring Order of Selected LEDs (R)"><i class="bi bi-arrow-left-right"></i></button>
                        <button class="btn btn-secondary" id="scale-selected-btn" data-bs-toggle="modal" data-bs-target="#scale-selected-modal" title="Scale Selected LEDs (S)"><i class="bi bi-arrows-angle-expand"></i></button>
                    </div>

                    <div class="btn-group me-2 mb-1" role="group">
                        <button class="btn btn-secondary" id="toggle-grid-btn" data-bs-toggle="tooltip" title="Toggle Grid (G)"><i class="bi bi-grid-3x3"></i></button>
                    </div>
                </div>

                <div id="right-panel-top" class="d-flex flex-column" style="overflow: hidden; background-color: #2b3035;">
                    <div id="component-canvas-container" class="m-auto position-relative bg-body-tertiary" style="width: 500px; height: 300px; border: 1px dashed grey; overflow: auto; background-color: #343a40;">
                        <canvas id="componentCanvas" width="1000" height="600"></canvas>
                    </div>
                </div>

                <div class="ms-auto ps-3 text-body-secondary d-flex align-items-center">
                    <i class="bi bi-crosshair me-2"></i>
                    <span id="coords-display" class="font-monospace" style="min-width: 100px;">---, ---</span>
                </div>
            </div>
        </div>

        <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 99999">
            <div id="app-toast" class="toast border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="5000" style="width: 350px; font-size: 1.1rem;">
                <div id="app-toast-header" class="toast-header d-flex align-items-center">
                    <i id="app-toast-icon" class="bi me-2"></i>
                    <strong class="me-auto" id="app-toast-title">Notification</strong>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
                <div class="toast-body" id="app-toast-body">
                </div>
            </div>
        </div>

        <div class="modal fade" id="load-project-modal" tabindex="-1">...</div>
        <div class="modal fade" id="save-project-modal" tabindex="-1">...</div>
        <div class="modal fade" id="notification-modal" tabindex="-1">...</div>
        <div class="modal fade" id="confirm-overwrite-modal" tabindex="-1">...</div>

        <div class="modal fade" id="help-modal" tabindex="-1" aria-labelledby="helpModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="helpModalLabel"><i class="bi bi-question-circle me-2"></i>Help & Quick Guide</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Welcome to the SRGB Component Builder. Here are the basics to get you started.</p>

                        <div class="accordion" id="help-accordion">

                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#help-canvas-controls" aria-expanded="true">
                                        <i class="bi bi-arrows-move me-2"></i><strong>Canvas Controls</strong>
                                    </button>
                                </h2>
                                <div id="help-canvas-controls" class="accordion-collapse collapse show" data-bs-parent="#help-accordion">
                                    <div class="accordion-body">
                                        <ul class="list-group">
                                            <li class="list-group-item"><strong>Pan Canvas:</strong> Hold the <strong>Middle Mouse Button</strong> and drag.</li>
                                            <li class="list-group-item"><strong>Zoom Canvas:</strong> Use the <strong>Mouse Wheel</strong> to zoom in and out.</li>
                                            <li class="list-group-item"><strong>Reset View:</strong> Click the <i class="bi bi-aspect-ratio"></i> (Reset Zoom) button or press `0`.</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#help-toolbar" aria-expanded="false">
                                        <i class="bi bi-tools me-2"></i><strong>Toolbar Explained</strong>
                                    </button>
                                </h2>
                                <div id="help-toolbar" class="accordion-collapse collapse" data-bs-parent="#help-accordion">
                                    <div class="accordion-body">
                                        <ul class="list-group">
                                            <li class="list-group-item">
                                                <strong><i class="bi bi-cursor-fill me-2"></i>Select Tool (V):</strong>
                                                Used to select LEDs.
                                                <ul>
                                                    <li>Click an LED to select it.</li>
                                                    <li>Hold <kbd>Shift</kbd> while clicking to add/remove LEDs from your selection.</li>
                                                    <li>Click and drag on an empty area to create a selection box.</li>
                                                    <li>Click and drag a selected LED to move the entire selection.</li>
                                                </ul>
                                            </li>
                                            <li class="list-group-item">
                                                <strong><i class="bi bi-image me-2"></i>Image Guide Tool (I):</strong>
                                                Used to position, scale, and rotate a persistent background image guide. The image guide is always **underneath the grid** and is **saved across sessions** until explicitly removed.
                                                <ul>
                                                    <li>Use the <i class="bi bi-upload"></i> button to load an image. The image will be resized on upload.</li>
                                                    <li>Click and drag the image to <strong>reposition</strong> it.</li>
                                                    <li>Drag the <strong>bottom-right</strong> handle (Scale handle) to <strong>scale</strong> the image.</li>
                                                    <li>Drag the <strong>top-left</strong> handle (Rotate handle) to <strong>rotate</strong> the image (snaps to 15°).</li>
                                                    <li>Use <kbd>L</kbd> or right-click to <strong>Lock/Unlock</strong> the image position.</li>
                                                    <li>Use <kbd>H</kbd> to <strong>Hide/Show</strong> the image.</li>
                                                    <li>Use the <i class="bi bi-trash"></i> button to <strong>remove</strong> the image guide completely.</li>
                                                </ul>
                                            </li>
                                            <li class="list-group-item">
                                                <strong><i class="bi bi-circle-fill me-2"></i>Place LED Tool (P):</strong>
                                                Click on the grid to place an LED. Each subsequent click will place a new LED and automatically wire it to the previous one in a chain.
                                                <ul>
                                                    <li><strong>Right-click</strong> to stop the current chain.</li>
                                                </ul>
                                            </li>
                                            <li class="list-group-item">
                                                <strong><i class="bi bi-vector-pen me-2"></i>Wiring Tool (W):</strong>
                                                Used to manually connect LEDs.
                                                <ul>
                                                    <li>Click an unwired LED or the end-point of a chain to start a wire.</li>
                                                    <li>Click another valid LED (unwired or an end-point) to complete the connection.</li>
                                                    <li><strong>Right-click an LED</strong> to remove it from its wire chain.</li>
                                                    <li><strong>Right-click a wire segment</strong> to break the circuit in two at that point.</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#help-shortcuts" aria-expanded="false">
                                        <i class="bi bi-keyboard me-2"></i><strong>Keyboard Shortcuts</strong>
                                    </button>
                                </h2>
                                <div id="help-shortcuts" class="accordion-collapse collapse" data-bs-parent="#help-accordion">
                                    <div class="accordion-body">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <ul class="list-group">
                                                    <li class="list-group-item"><kbd>V</kbd> - Activate Select Tool</li>
                                                    <li class="list-group-item"><kbd>I</kbd> - Activate Image Guide Tool</li>
                                                    <li class="list-group-item"><kbd>P</kbd> - Activate Place LED Tool</li>
                                                    <li class="list-group-item"><kbd>W</kbd> - Activate Wiring Tool</li>
                                                    <li class="list-group-item"><kbd>L</kbd> - Toggle Image Lock/Unlock</li>
                                                    <li class="list-group-item"><kbd>H</kbd> - Toggle Image Hide/Show</li>
                                                </ul>
                                            </div>
                                            <div class="col-md-6">
                                                <ul class="list-group">
                                                    <li class="list-group-item"><kbd>G</kbd> - Toggle Grid</li>
                                                    <li class="list-group-item"><kbd>S</kbd> - Scale Selected LEDs</li>
                                                    <li class="list-group-item"><kbd>Delete</kbd> / <kbd>Backspace</kbd> - Delete Selected</li>
                                                    <li class="list-group-item"><kbd>+</kbd> (Numpad) - Zoom In</li>
                                                    <li class="list-group-item"><kbd>-</kbd> (Numpad) - Zoom Out</li>
                                                    <li class="list-group-item"><kbd>0</kbd> (Numpad) - Reset Zoom</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <h6 class="mt-3">Actions</h6>
                                        <ul class="list-group">
                                            <li class="list-group-item"><strong>Click <i class="bi bi-arrow-counterclockwise"></i> Button:</strong> Rotate selected 90° counter-clockwise.</li>
                                            <li class="list-group-item"><strong><kbd>Shift</kbd> + Click <i class="bi bi-arrow-counterclockwise"></i> Button:</strong> Rotate selected 90° clockwise.</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#help-saving" aria-expanded="false">
                                        <i class="bi bi-cloud-arrow-up me-2"></i><strong>Saving & Loading</strong>
                                    </button>
                                </h2>
                                <div id="help-saving" class="accordion-collapse collapse" data-bs-parent="#help-accordion">
                                    <div class="accordion-body">
                                        <div class="alert alert-info"><i class="bi bi-exclamation-circle-fill me-2"></i>You must be <strong>signed in</strong> to save components to the cloud.</div>
                                        <ul class="list-group">
                                            <li class="list-group-item"><strong>New:</strong> Clears the canvas. It will ask for confirmation if you have unsaved changes. *Note: The Image Guide remains loaded unless explicitly removed.*</li>
                                            <li class="list-group-item"><strong>Save:</strong> Saves your current component and the Image Guide to the cloud under your account. If you loaded a community component, this will "fork" it and save a new copy for you.</li>
                                            <li class="list-group-item"><strong>Import JSON:</strong> Lets you load a component from a `.json` file from your computer.</li>
                                            <li class="list-group-item"><strong>Export JSON:</strong> Generates a `.json` file for use in SignalRGB. <strong>All LEDs must be wired</strong> for the export to be valid.</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Got it!</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="about-modal" tabindex="-1" aria-labelledby="aboutModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="aboutModalLabel">About SRGB Component Builder</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p><strong>SRGB Component Builder</strong> is a web-based visual tool designed to simplify the creation of custom component <code>.json</code> files for the <a href="https://signalrgb.com/" target="_blank">SignalRGB</a> platform.</p>
                        <p>Built by José A. Miranda Vélez in the beautiful island of Puerto Rico, this project aims to provide an intuitive, grid-based interface for designers and enthusiasts to map out LEDs for their custom devices.</p>
                        <ul class="list-group">
                            <li class="list-group-item">
                                <strong>Version:</strong> <span id="version-display">1.0</span>
                            </li>
                            <li class="list-group-item">
                                <strong>Project Home:</strong> <a href="https://github.com/joseamirandavelez" target="_blank">View on GitHub</a>
                            </li>

                            <li class="list-group-item">
                                <strong>Related Tool:</strong> <a href="https://effectbuilder.github.io/" target="_blank" rel="noopener">Effect Builder</a>
                            </li>
                            <li class="list-group-item">
                                <strong>Terms & Privacy:</strong>
                                <a href="#" data-bs-toggle="modal" data-bs-target="#terms-modal" data-bs-dismiss="modal">Terms of Usage</a> |
                                <a href="#" data-bs-toggle="modal" data-bs-target="#privacy-policy-modal" data-bs-dismiss="modal">Privacy Policy</a>
                            </li>
                        </ul>
                        <h6 class="mt-4">Credits & Technology</h6>
                        <p>This tool is built using <a href="https://firebase.google.com/" target="_blank">Firebase</a> for cloud storage and authentication, and <a href="https://getbootstrap.com/" target="_blank">Bootstrap</a> for the user interface.</p>
                    </div>
                    <div class="modal-footer">
                        <div class="text-muted small me-auto">© 2025 José A. Miranda Vélez. All Rights Reserved.</div>
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="terms-modal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="termsModalLabel">Terms of Usage</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>By using this Interactive Effect Builder (the "Tool"), you agree to the following terms:</p>

                        <h6 class="mt-4">1. No Warranty</h6>
                        <p>This Tool is provided "as-is", without any warranties of any kind, express or implied. The
                            developer makes no guarantees regarding its functionality, reliability, or suitability for any
                            particular purpose.</p>

                        <h6 class="mt-4">2. Limitation of Liability</h6>
                        <p>In no event shall the developer be liable for any claim, damages, or other liability arising from
                            the use of, or inability to use, the Tool.</p>

                        <h6 class="mt-4">3. User Responsibility</h6>
                        <p>You are solely responsible for the effects you create and their use. It is your responsibility to
                            ensure they comply with the terms of service of any platform or application they are used with,
                            including SignalRGB.</p>

                        <h6 class="mt-4">4. Content Disclaimer</h6>
                        <p>The developer is not responsible for any content, including effects, created or shared by users of this Tool. Some user-generated effects may be inappropriate or unsuitable for certain audiences. Use caution when sharing or loading effects from others.</p>

                        <h6 class="mt-4">5. License</h6>
                        <p>This project is licensed under the GNU General Public License v3.0. You may copy, distribute and modify the software as long as you track changes/dates in source files and keep modifications under the same license. The software is provided "as is", without warranty of any kind. For the full license text, please see the <a href="https://www.gnu.org/licenses/gpl-3.0.html" target="_blank">official GNU GPLv3 page</a>.</p>

                        <h6 class="mt-4">6. Public Content and Licensing</h6>
                        <p>By saving or sharing an effect, you are making it public. You grant a perpetual, worldwide, non-exclusive, royalty-free license to other users and to this website to use, display, reproduce, and distribute your created effect. This allows features like the Community Gallery to function.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="accept-terms2-btn" data-bs-dismiss="modal">I Accept</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="privacy-policy-modal" tabindex="-1" aria-labelledby="privacyPolicyModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="privacyPolicyModalLabel">Privacy Policy</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p><em>Last Updated: November 3, 2025</em></p>
                        <p>This Privacy Policy describes how we handle information in the SRGB Component Builder (the "Tool").</p>

                        <h6 class="mt-4">Information We Collect</h6>
                        <ul>
                            <li><strong>Account Information:</strong> If you choose to sign in with Google, we collect your public profile information, including your name, photo, and unique user ID.</li>
                            <li><strong>User-Generated Content:</strong> We collect the components you save to the cloud, which includes all configuration data, names, and descriptions you provide.</li>
                            <li><strong>Browser Storage:</strong> The Tool uses your browser's `localStorage` to remember that you have accepted the Terms of Usage, so you are not prompted on every visit, and to save your progress until you save a component to the cloud.</li>
                        </ul>

                        <h6 class="mt-4">How We Use Information</h6>
                        <ul>
                            <li>To associate your saved components with your user profile.</li>
                            <li>To display your public display name and profile photo next to your creations in the Community Gallery.</li>
                            <li>To operate and maintain the Tool and its features, such as the cloud-saving and sharing functionalities.</li>
                        </ul>

                        <h6 class="mt-4">Information Sharing</h6>
                        <p>Your saved components and your public display name are visible to other users when they browse the Community Gallery. We do not share or sell your personal information with third parties.</p>

                        <h6 class="mt-4">Your Rights</h6>
                        <p>You have the right to delete your saved effects. This can be done from the "Community Gallery" section when you are signed in.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="accept-terms-modal" tabindex="-1" aria-labelledby="acceptTermsModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="acceptTermsModalLabel"><i class="bi bi-shield-check me-2"></i>Terms & Privacy</h5>
                    </div>
                    <div class="modal-body">
                        <p>By using this tool, you agree to the <a href="#" data-bs-toggle="modal" data-bs-target="#terms-modal" data-bs-dismiss="modal">Terms of Usage</a> and acknowledge our <a href="#" data-bs-toggle="modal" data-bs-target="#privacy-policy-modal" data-bs-dismiss="modal">Privacy Policy</a>.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="accept-terms-btn" data-bs-dismiss="modal">I Accept</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="offcanvas offcanvas-end" tabindex="-1" id="gallery-offcanvas" aria-labelledby="galleryOffcanvasLabel" style="width: 500px;">

            <div class="offcanvas-header">
                <h5 class="offcanvas-title" id="galleryOffcanvasLabel"><i class="bi bi-folder2-open me-2"></i>Open Component</h5>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>

            <div class="offcanvas-body d-flex flex-column">
                <div id="gallery-controls" class="mb-3">
                    <div class="mb-2">
                        <input type="search" id="gallery-search-input" class="form-control" placeholder="Search by name...">
                    </div>
                    <div class="row g-2 row-cols-1 row-cols-md-3">
                        <div class="col">
                            <label for="gallery-filter-type" class="form-label form-label-sm">Type</label>
                            <select id="gallery-filter-type" class="form-select form-select-sm">
                                <option value="all" selected>All Types</option>
                            </select>
                        </div>
                        <div class="col">
                            <label for="gallery-filter-brand" class="form-label form-label-sm">Brand</label>
                            <select id="gallery-filter-brand" class="form-select form-select-sm">
                                <option value="all" selected>All Brands</option>
                            </select>
                        </div>
                        <div class="col">
                            <label for="gallery-filter-leds" class="form-label form-label-sm">LEDs</label>
                            <select id="gallery-filter-leds" class="form-select form-select-sm">
                                <option value="all" selected>All Counts</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div id="user-component-list" class="list-group flex-grow-1 overflow-auto">
                </div>

                <div id="gallery-footer" class="mt-3 text-center">
                    <div id="gallery-loading-spinner" class="spinner-border" role="status" style="display: none;">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="share-modal" tabindex="-1" aria-labelledby="shareModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="shareModalLabel"><i class="bi bi-share me-2"></i>Share Component</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Anyone with this link can view and fork this component. Your original component will not be affected.</p>
                        <div class="input-group">
                            <span class="input-group-text"><i class="bi bi-link-45deg"></i></span>
                            <input type="text" id="share-url-input" class="form-control" value="Generating link..." readonly>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary" id="copy-share-url-btn"><i class="bi bi-clipboard-check me-2"></i>Copy Link</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="export-component-modal" tabindex="-1" aria-labelledby="exportComponentModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exportComponentModalLabel"><i class="bi bi-filetype-json me-2"></i>Export Component</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">

                        <div class="mb-3">
                            <label class="form-label">Export Format:</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="export-format" id="export-format-srgb" value="srgb" checked>
                                <label class="form-check-label" for="export-format-srgb">
                                    SignalRGB (Standard)
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="export-format" id="export-format-wled" value="wled">
                                <label class="form-check-label" for="export-format-wled">
                                    WLED (Matrix Map)
                                </label>
                            </div>

                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="export-format" id="export-format-nolliergb" value="nolliergb">
                                <label class="form-check-label" for="export-format-nolliergb">
                                    NollieRGB
                                </label>
                            </div>
                        </div>
                        <p>Your component JSON preview:</p>
                        <pre id="json-preview" style="max-height: 300px; overflow: auto; background-color: var(--bs-tertiary-bg); padding: 10px; border-radius: 5px;"><code>{...}</code></pre>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="copy-export-json-btn"><i class="bi bi-clipboard me-2"></i>Copy JSON</button>
                        <button type="button" class="btn btn-primary" id="confirm-export-json-btn"><i class="bi bi-download me-2"></i>Download .json</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="add-matrix-modal" tabindex="-1" aria-labelledby="addMatrixModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addMatrixModalLabel"><i class="bi bi-grid-3x3-gap me-2"></i>Add LED Matrix</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>A grid of LEDs will be created at the center of your view.</p>
                        <div class="row mb-3">
                            <div class="col">
                                <label for="matrix-cols" class="form-label">Columns</label>
                                <input type="number" id="matrix-cols" class="form-control" value="8" min="1">
                            </div>
                            <div class="col">
                                <label for="matrix-rows" class="form-label">Rows</label>
                                <input type="number" id="matrix-rows" class="form-control" value="8" min="1">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <label for="matrix-wiring" class="form-label">Wiring Direction</label>
                                <select id="matrix-wiring" class="form-select">
                                    <option value="horizontal" selected>Horizontal (Left-to-Right)</option>
                                    <option value="vertical">Vertical (Top-to-Bottom)</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <div class="form-check form-switch mt-3">
                                    <input class="form-check-input" type="checkbox" role="switch" id="matrix-serpentine" checked>
                                    <label class="form-check-label" for="matrix-serpentine">Serpentine Wiring</label>
                                </div>
                                <div class="form-text">If checked, wiring snakes back and forth. If unchecked, each line starts from the beginning.</div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="confirm-add-matrix-btn">Create Matrix</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="add-strip-modal" tabindex="-1" aria-labelledby="addStripModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addStripModalLabel"><i class="bi bi-grip-horizontal me-2"></i>Add LED Strip</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row mb-3">
                            <div class="col">
                                <label for="strip-led-count" class="form-label">LED Count</label>
                                <input type="number" id="strip-led-count" class="form-control" value="10" min="1">
                            </div>
                            <div class="col">
                                <label for="strip-orientation" class="form-label">Orientation</label>
                                <select id="strip-orientation" class="form-select">
                                    <option value="horizontal" selected>Horizontal</option>
                                    <option value="vertical">Vertical</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="confirm-add-strip-btn">Create Strip</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="add-circle-modal" tabindex="-1" aria-labelledby="addCircleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addCircleModalLabel"><i class="bi bi-circle-dotted me-2"></i>Add LED Circle</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row mb-3">
                            <div class="col">
                                <label for="circle-led-count" class="form-label">LED Count</label>
                                <input type="number" id="circle-led-count" class="form-control" value="12" min="1">
                            </div>
                            <div class="col">
                                <label for="circle-radius" class="form-label">Radius (grid units)</label>
                                <input type="number" id="circle-radius" class="form-control" value="5" min="1">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="confirm-add-circle-btn">Create Circle</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="add-l-shape-modal" tabindex="-1" aria-labelledby="addLShapeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addLShapeModalLabel"><i class="bi bi-justify-left me-2"></i>Add L-Shape</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Creates an L-shape with the corner at the bottom-left. Wiring runs top-to-bottom, then left-to-right.</p>
                        <div class="row mb-3">
                            <div class="col">
                                <label for="l-shape-a-leds" class="form-label">Side A (Vertical)</label>
                                <input type="number" id="l-shape-a-leds" class="form-control" value="5" min="1">
                            </div>
                            <div class="col">
                                <label for="l-shape-b-leds" class="form-label">Side B (Horizontal)</label>
                                <input type="number" id="l-shape-b-leds" class="form-control" value="5" min="1">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="confirm-add-l-shape-btn">Create L-Shape</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="add-u-shape-modal" tabindex="-1" aria-labelledby="addUShapeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addUShapeModalLabel"><i class="bi bi-reception-3 me-2"></i>Add U-Shape</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Wiring runs down Side A, across Side B, and up Side C.</p>
                        <div class="row mb-3">
                            <div class="col">
                                <label for="u-shape-a-leds" class="form-label">Side A (Left)</label>
                                <input type="number" id="u-shape-a-leds" class="form-control" value="4" min="1">
                            </div>
                            <div class="col">
                                <label for="u-shape-b-leds" class="form-label">Side B (Bottom)</label>
                                <input type="number" id="u-shape-b-leds" class="form-control" value="4" min="1">
                            </div>
                            <div class="col">
                                <label for="u-shape-c-leds" class="form-label">Side C (Right)</label>
                                <input type="number" id="u-shape-c-leds" class="form-control" value="4" min="1">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="confirm-add-u-shape-btn">Create U-Shape</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="add-lili-modal" tabindex="-1" aria-labelledby="addLiLiModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addLiLiModalLabel">Add LiLi Logo Shape</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Based on the icon, this creates two vertical strips and one circle as three separate wiring circuits.</p>
                        <div class="row mb-3">
                            <div class="col">
                                <label for="lili-strip-leds" class="form-label">Strip LEDs</label>
                                <input type="number" id="lili-strip-leds" class="form-control" value="3" min="1">
                            </div>
                            <div class="col">
                                <label for="lili-circle-leds" class="form-label">Circle LEDs</label>
                                <input type="number" id="lili-circle-leds" class="form-control" value="8" min="1">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <label for="lili-circle-radius" class="form-label">Circle Radius</label>
                                <input type="number" id="lili-circle-radius" class="form-control" value="4" min="1">
                            </div>
                            <div class="col">
                                <label for="lili-spacing" class="form-label">Spacing</label>
                                <input type="number" id="lili-spacing" class="form-control" value="2" min="1">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="confirm-add-lili-btn">Create Shape</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="add-hexagon-modal" tabindex="-1" aria-labelledby="addHexagonModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addHexagonModalLabel"><i class="bi bi-hexagon me-2"></i>Add Hexagon</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row mb-3">
                            <div class="col">
                                <label for="hexagon-leds-per-side" class="form-label">LEDs per Side</label>
                                <input type="number" id="hexagon-leds-per-side" class="form-control" value="4" min="2">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="confirm-add-hexagon-btn">Create Hexagon</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="add-triangle-empty-modal" tabindex="-1" aria-labelledby="addTriangleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addTriangleModalLabel"><i class="bi bi-triangle me-2"></i>Add Triangle</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row mb-3">
                            <div class="col">
                                <label for="triangle-leds-per-side" class="form-label">LEDs per Side</label>
                                <input type="number" id="triangle-leds-per-side" class="form-control" value="5" min="2">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="confirm-add-triangle-empty-btn">Create Triangle</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="scale-selected-modal" tabindex="-1" aria-labelledby="scaleSelectedModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="scaleSelectedModalLabel"><i class="bi bi-arrows-angle-expand me-2"></i>Scale Selected LEDs</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Scale the selection relative to its **geometric center**.</p>
                        <div class="row mb-3">
                            <div class="col">
                                <label for="scale-factor-input" class="form-label">Scale Factor</label>
                                <input type="number" id="scale-factor-input" class="form-control" value="1.5" min="0.1" step="0.1">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="confirm-scale-btn">Scale</button>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="util.js" type="module"></script>
    <script src="firebase.js" type="module"></script>
    <script src="canvas.js" type="module"></script>
    <script src="main.js" type="module"></script>

    <input type="file" id="import-file-input" class="d-none" accept=".json,application/json">
    <input type="file" id="image-upload-input" class="d-none" accept="image/png, image/jpeg, image/webp">
</body>

</html>